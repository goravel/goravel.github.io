# Mise √† jour vers la v1.13 de la v1.12

### Nouvelles fonctionnalit√©s int√©ressantes üéâ

- [Seeding](#seeding)
- [Factories](#factories)
- [Testing](#testing)
- [Views](#views)

## Am√©liorations üöÄ

- [Mettre √† niveau la version par d√©faut de Golang vers 1.20](#upgrade-the-default-version-of-golang-to-1-20)
- [Planification des t√¢ches prend en charge l'√©chelle horizontalement] (#schedule-supports-scale-horizontally)
- (#add-debug-methods)
- [make:controller Command Ajoute le param√®tre](#make-controller-command-adds-parameter)
- (#add-status-method-for-response)
- [Ajouter une somme et des m√©thodes de curseur pour l'orme](#add-sum-and-cursor-methods-for-orm)
- [Le module Route prend en charge le pilote de configuration](#the-route-module-supports-configure-driver)
- [Ajouter des m√©thodes d'InputArray et InputMap pour la requ√™te](#add-inputarray-and-inputmap-methods-for-request)
- [Le mod√®le de l'orme prend en charge la connexion personnalis√©e](#the-model-of-orm-supports-custom-connection)
- [Ajouter un pilote nuageux pour le syst√®me de fichiers](#add-cloudinary-driver-for-filesystem)
- [Ajouter de nouvelles m√©thodes de cha√Æne pour les logs](#add-new-chain-methods-for-log)

### v1.13.4

- [Le d√©marrage du service prend en charge les variables d'environnement](#the-service-startup-supports-environment-variables)

## Changements en cours :hammer_and_wclch:

- [Enlever le Middleware HTTP Global charg√© par D√©faut](#_5-remove-the-global-http-middleware-loaded-by-default)
- [Optimiser le retour du contr√¥leur](#_6-optimize-the-return-of-controller)
- [Changer le param√®tre de la m√©thode de groupe en facades.Route()](#_7-change-the-parameter-of-the-group-method-in-facades-route)
- [Optimiser Rappelez-vous Et RememberForever Methods In facades.Cache()(Si vous utilisez)](#_8-optimize-remember-and-rememberforever-methods-in-facades-cache-if-using)
- [Changer le nom du paquet d'acc√®s.NewAllowResponse et access.NewDenyResponse(Si vous utilisez)](#_9-change-the-package-name-of-access-newallowresponse-and-access-newdenyresponse-if-using)
- [Enlever les m√©thodes obsol√®tes(Si vous utilisez)](#_10-remove-deprecated-methods-if-using)

### Corrections de bugs üêõ

- [Corriger facades.Auth().User()](#fix-facades-auth-user)
- [R√©parer le chemin .env personnalis√© ne prend pas effet dans certains cas](#fix-custom-env-path-does-not-take-effect-in-some-cases)
- [Correction du jeton Expire imm√©diatement quand ttl == 0 est d√©fini dans JWT](#fix-token-expires-immediately-when-ttl-0-is-set-in-jwt)

#### v1.13.2

- [Corriger facades.Storage().Url() retourne un chemin erron√© sous Windows](#fix-facades-storage-url-returns-wrong-path-under-windows)
- [Corriger la connexion anormale lorsque le mot de passe Postgres est vide](#fix-abnormal-connection-when-the-postgres-password-is-empty)
- [Corriger la m√©thode avec la m√©thode avec le curseur n'est pas valide lorsque vous utilisez la m√©thode du curseur d'orme](#fix-the-with-method-is-invalid-when-using-the-cursor-method-of-orm)

#### v1.13.4

- [R√©parer le module de validation ne peut pas v√©rifier les param√®tres de la route](#fix-the-validation-module-cant-verify-the-route-params)
- [Corriger le fichier de retour du pilote de fibre](#fix-the-fiber-driver-cant-return-file)
- [Corriger le Middleware Global Of Fiber Driver Panic](#fix-the-global-middleware-of-fiber-driver-panic)
- [R√©parer le param√®tre de type de contenu du pilote de fibre est diff√©rent du pilote de gaz](#fix-the-contenttype-setting-of-fiber-driver-is-different-from-gin-driver)

#### v1.13.5

- [R√©parer la connexion du mod√®le ne fonctionne pas](#fix-the-connection-of-model-does-not-work)
- [Corriger le journal d'erreurs du cr√©puscule](#fix-the-error-of-mock-log)

#### v1.13.6 v1.13.7

- [Corriger le probl√®me de l'ex√©cution non-lin√©aire de la cha√Æne de requ√™tes](#fix-the-problem-of-nonlinear-execution-of-query-chain)

#### v1.13.8

- [Corriger le probl√®me des facades.Auth().Parse()](#fix-the-problem-of-facades-auth-parse)
- [Corriger le probl√®me des facades.Orm().WithContext()](#fix-the-problem-of-facades-orm-withcontext)
- [Le journal de file d'attente est contr√¥l√© par APP_DEBUG](#the-queue-log-is-controlled-by-app-debug)

#### v1.13.9

- [R√©soudre le probl√®me de la nouvelle ligne d'impression du journal est incorrect](#fix-the-problem-of-the-new-line-print-of-log-is-incorrect)
- [R√©soudre le probl√®me du vendeur:publier le r√©pertoire ne peut pas √™tre publi√©](#fix-the-problem-of-the-vendor-publish-commabnd-can-not-publish-directory)

### v1.13.10

- [Corriger les traces ne sont pas nettoy√©es lors d'un appel √† Log.Info apr√®s Log.Error](#fix-the-traces-do-not-cleaned-when-calling-log-info-after-log-error)
- [Fix The GetAttribute Of Orm Event Returns Error Data](#fix-the-getattribute-of-orm-event-returns-error-data)
- [Ajouter ToSql, M√©thodes ToRawSql pour ORM](#add-tosql-torawsql-methods-for-orm)

## Guide de mise √† jour

Veuillez mettre √† jour le framework √©tape par √©tape en fonction du contenu de cette section.

**Temps d'am√©lioration estim√© : 10 minutes**

### 1. Mise √† jour des d√©pendances

Mettre √† jour les d√©pendances dans le fichier `go.mod` :

```
aller chercher -u github.com/goravel/framework@v1.13.9 && aller chercher -u github.com/goravel/gin
```

### 2. Ajouter de nouveaux fichiers

[tests](https://github.com/goravel/goravel/tree/v1.13.x/tests)

[database/seeders/database_seeder.go](https://github.com/goravel/goravel/tree/v1.13.x/database/seeders/database_seeder.go)

[app/providers/database_service_provider.go](https://github.com/goravel/goravel/tree/v1.13.x/app/providers/database_service_provider.go)

### 3. Enregistrer les nouveaux fournisseurs

Notez la commande :

```go
import (
  "github.com/goravel/framework/testing"
  "github.com/goravel/gin"
)

// config/app. o
"providers": []foundation.ServiceProvider{
  ...
  &validation.ServiceProvider{},
  // New
  &testing. erviceProvider{}, 
  &providers.AppServiceProvider{},
  ...
  &providers. alidationServiceProvider{},
  // Nouveau
  &providers.DatabaseServiceProvider{}, 
  // Nouveau
  &gin.ServiceProvider{}, 
}
```

### 4. Ajouter une configuration

Modifier [config/http.go](https://github.com/goravel/goravel/tree/v1.13.x/config/http.go)

```go
import (
  "github.com/goravel/framework/contracts/route"
  "github.com/goravel/framework/facades"
  ginfacades "github.com/goravel/gin/facades"
)

config. dd("http", map[string]any{
  // HTTP Driver
  "default": "gin",
  // HTTP Drivers
  "drivers": map[string]any{
    "gin": map[string]any{
      "route": func() (route. ex., erreur) {
        return ginfacades. oute("gin"), nil
      },
    },
  },
  .
}
```

Modifier [config/cors.go](https://github.com/goravel/goravel/tree/v1.13.x/config/cors.go)

```go
config.Add("cors", map[string]any{
  ...
  // Nouveau
  "paths": []string{"*"}, 
  "allowed_methods": []string{"*"},
  ...
}
```

### 5. Supprimer le Middleware HTTP global charg√© par d√©faut

1. Les middleware `tls` et `cors` ont √©t√© int√©gr√©s dans le pilote HTTP par d√©faut, donc `middleware. ors()` et
  `middleware.Tls()` dans le fichier `app/http/kernel.go` doivent √™tre supprim√©s.

2. Le fichier `facades.Route().GlobalMiddleware(http.Kernel{}.Middleware()...)` dans la m√©thode
  `app/providers/route_service_provider.go` se d√©place vers `Boot` depuis `Register`:

```go
Fournisseurs de paquets

...

type RouteServiceProvider struct {
}

func (receiver *RouteServiceProvider) Register(app foundation. pplication) {
}

func (receiver *RouteServiceProvider) Boot(app foundation. pplication) {
  //Add HTTP middleware
  facades.Route().GlobalMiddleware(http.Kernel{}.Middleware()...)

  receiver. onfigureRateLimiting()

  routes.Web()
}

func (r√©cepteur *RouteServiceProvider) configureRateLimiting() {

}
```

### 6. Optimiser le retour du contr√¥leur

`Controller` ajoute la valeur de retour `http.Response`, `ctx.Response()` peut √™tre retourn√© directement, il n'y a pas besoin d'utiliser
`return` s√©par√©ment pour rendre la logique plus lisse.

```go
// Avant
func (r *UserController) Show(ctx http.Context) {
  ctx.Response().Success().Json(http. son{
    "Bonjour": "Goravel",
  })
  return
}

// Apr√®s
func (r *UserController) Show(ctx http. ontext) http.Response {
  return ctx.Response().Success().Json(http.Json{
    "Hello": "Goravel",
  })
}
```

### 7. Changer le param√®tre de la m√©thode de groupe en facades.Route()

Changez `route.Route` en `route.Router`Ôºö

```go
// Avant
facades.Route().Group(func(route route.Route)

// Apr√®s
facades.Route().Group(func(route route.Router)
```

### 8. Optimiser Rappelez-vous Et RememberForever M√©thodes Dans facades.Cache()(Si utilis√©)

Le type de `callback` change √† `func() (any, error)` de `func() any`:

```go
// Avant
Remember(key string, ttl time. uration, callback func() any) (any, error)
RememberForever(key string, callback func() any) (any, error)

// After
Remember(key string, ttl time. uration, callback func() (any, error)) (any, error)
RememberForever(key string, callback func() (any, error)) (any, error) (any, error)
```

### 9. Changer le nom du paquet d'acc√®s.NewAllowResponse et access.NewDenyResponse(Si utilis√©)

Changez `/contracts/auth/access` en `/auth/access`:

```go
// Avant
import "github.com/goravel/framework/contracts/auth/access"

access.NewAllowResponse()
access.NewDenyResponse()

// Apr√®s
import "github.com/goravel/framework/auth/access"

access.NewAllowResponse()
access.NewDenyResponse()
```

### 10. Supprimer les m√©thodes obsol√®tes (si utilis√©)

1. Supprimez les m√©thodes `ctx.Request().Form()` et `ctx.Request().Json()`, utilisez la m√©thode `ctx.Request().Input()` √† la place;

2. Supprimez les m√©thodes `GetLevel`, `GetTime`, `GetMessage` du pilote personnalis√© `Log`, utilisez `Level`, `Time`, `Message` m√©thodes
  √† la place;

3. Supprime la m√©thode `gorm.New`, la m√©thode est utilis√©e pour obtenir directement l'instance `gorm`. Il n'est plus recommand√©.
  si n√©cessaire, utilisez la m√©thode `gorm.NewGormImpl` √† la place;

## Introduction √† la fonction

### Sources

Version : v1.13.1

[Pour le d√©tail](../orm/seeding)

### Usines

Version : v1.13.1

[Pour le d√©tail](../orm/factories)

### Tests en cours

Version : v1.13.1

[Pour le d√©tail](../testing/quickstart)

### Vues

Version : v1.13.1

[Pour le d√©tail](../basic/views)

### Mise √† niveau de la version par d√©faut de Golang vers 1.20

Version : v1.13.1

Golang 1.18 et 1.19 ont √©t√© arr√™t√©s et le cadre a √©t√© mis √† niveau vers 1.20
en cons√©quence, [pour plus de d√©tails](https://endoflife.date/go). Si vous voulez continuer √† utiliser la version 1.18 ou 1.19, il vous suffit de modifier le num√©ro de version
dans `go.mod`, ils sont actuellement enti√®rement compatibles.

### La planification des t√¢ches prend en charge l'√©chelle horizontale

Version : v1.13.1

[Pour le d√©tail](../advanced/schedule#running-tasks-on-one-server)

### Ajouter des m√©thodes de d√©bogage

Version : v1.13.1

[Pour le d√©tail](../advanced/helpers#debug)

### make:controller Command ajoute le param√®tre

Version : v1.13.1

La commande `make:controller` ajoute le param√®tre `--resource`, la structure CURD peut √™tre cr√©√©e facilement :

```
ex√©cutez . artisan make:controller --resource UserController
```

### Ajouter une m√©thode de statut pour la r√©ponse

Version : v1.13.1

[Pour le d√©tail](../basic/responses#custom-code)

### Ajouter les m√©thodes Somme et Curseur pour Orm

Version : v1.13.1

[Pour le d√©tail](../orm/quickstart#facades-orm-query-facades-orm-transaction-available-functions)

### Le module Route prend en charge le pilote de configuration

Version : v1.13.1

S√©parez le pilote original Gin par d√©faut du module Route dans un paquet, il peut √™tre inject√© dans Goravel par
configuration. apr√®s cette optimisation, les fournisseurs fournissent un canal pratique pour l'injection d'autres paquets HTTP dans Goravel,
actuellement deux paquets HTTP sont officiellement pris en charge :

| Chauffeur | Lier                                                                                                    |
| --------- | ------------------------------------------------------------------------------------------------------- |
| Gin       | [https://github.com/goravel/gin](https://github.com/fr/goravel/gin)     |
| Fibre     | [https://github.com/goravel/fiber](https://github.com/fr/goravel/fiber) |

### Ajouter les M√©thodes InputArray et InputMap pour la Requ√™te

Version : v1.13.1

[Pour le d√©tail](../basic/requests#retrieving-an-input-value)

### Le Mod√®le d‚Äôorme prend en charge la connexion personnalis√©e

Version : v1.13.1

[Pour le d√©tail](../orm/quickstart#database-connections)

### Ajouter un pilote nuageux pour le syst√®me de fichiers

Version : v1.13.1

[Pour le d√©tail](https://github.com/goravel/cloudinary)

### Ajouter une nouvelle m√©thode de cha√Æne pour le journal

Version : v1.13.1

[Pour le d√©tail](../basic/logging#chain-methods)

### Corriger facades.Auth().User()

Version : v1.13.1

1. Corrige le probl√®me qu'aucune erreur ne d√©clenche si l'utilisateur n'existait pas en utilisant la m√©thode `facades.Auth().User(ctx, &user)`
  .

2. Corrige le probl√®me que `user` peut √™tre trouv√© quand la cl√© primaire n'est pas `int`;

### Corriger le chemin .env personnalis√© ne prend pas d'effet dans certains cas

Version : v1.13.1

Corrige le probl√®me que le chemin personnalis√© .env ne prend pas effet dans certains cas.

### Corriger le jeton expire imm√©diatement lorsque ttl == 0 est d√©fini dans JWT

Version : v1.13.1

Attendez-vous √† ce que le jeton n'expire jamais lorsque `ttl == 0`.

### Corriger facades.Storage().Url() retourne un chemin erron√© sous Windows

Version : v1.13.2

[Ticket #263](https://github.com/goravel/goravel/issues/263)

### Corriger la connexion anormale lorsque le mot de passe Postgres est vide

Version : v1.13.2

[Ticket #270](https://github.com/goravel/goravel/issues/270)

### Corriger la m√©thode avec la m√©thode avec le curseur n'est pas valide lorsque vous utilisez la m√©thode du curseur de l'orme

Version : v1.13.2

[Ticket #253](https://github.com/goravel/goravel/issues/253)

### Le service de d√©marrage prend en charge les variables d'environnement

Version : v1.13.4

[Ticket #265](https://github.com/goravel/goravel/issues/265)

### Corriger le module de validation ne peut v√©rifier les param√®tres de la route

goravel/gin: v1.1.6

goravel/fiber: v1.1.11

[Ticket #294](https://github.com/goravel/goravel/issues/294)

### Corriger le fichier de retour du pilote de fibre

goravel/fiber: v1.1.11

[Ticket #299](https://github.com/goravel/goravel/issues/299)

### Corriger la panique mondiale du pilote de fibre

goravel/fiber: v1.1.11

[Ticket #300](https://github.com/goravel/goravel/issues/300)

### Corriger le param√®tre de type de contenu du pilote de fibre est diff√©rent du pilote Gin

goravel/fiber: v1.1.11

[Ticket #296](https://github.com/goravel/goravel/issues/296)

### R√©parer la connexion du mod√®le ne fonctionne pas

goravel/framework: v1.13.5

[Ticket #312](https://github.com/goravel/goravel/issues/312)

### Corriger l'erreur du journal fictif

goravel/framework: v1.13.5

[Ticket #320](https://github.com/goravel/goravel/issues/320)

### Corriger le probl√®me de l'ex√©cution non-lin√©aire de la cha√Æne de requ√™te

goravel/framework: v1.13.6 v1.13.7

[Ticket #341](https://github.com/goravel/goravel/issues/341)

### Corrige le probl√®me de facades.Auth().Parse()

goravel/framework: v1.13.8

[Ticket #388](https://github.com/goravel/goravel/issues/388)

### Corrige le probl√®me des facades.Orm().WithContext()

goravel/framework: v1.13.8

[Probl√®me #390](https://github.com/goravel/goravel/issues/390)

### Le journal de file d'attente est contr√¥l√© par APP_DEBUG

goravel/framework: v1.13.8

Les niveaux `Debug` et `Info` ne seront pas affich√©s lorsque `APP_DEBUG=false`

[Ticket #389](https://github.com/goravel/goravel/issues/389)

### Corriger le probl√®me de la nouvelle ligne d'impression du journal est incorrect

goravel/framework: v1.13.9

[Ticket #395](https://github.com/goravel/goravel/issues/395)

### Corriger le probl√®me du vendeur:publier la virgule ne peut pas publier le r√©pertoire

goravel/framework: v1.13.9

[Ticket #345](https://github.com/goravel/goravel/issues/345)

### Corriger les traces ne sont pas nettoy√©es lors d'un appel √† Log.Info apr√®s le log.Error

goravel/framework: v1.13.10

[Ticket #402](https://github.com/goravel/goravel/issues/402)

### Corriger les retours d'erreurs des √©v√©nements GetAttribute Of Orm

goravel/framework: v1.13.10

[Ticket #405](https://github.com/goravel/goravel/issues/405)

### Ajouter ToSql, ToRawSql Methods for ORM

goravel/framework: v1.13.10

[Probl√®me #411](https://github.com/goravel/goravel/issues/411)
