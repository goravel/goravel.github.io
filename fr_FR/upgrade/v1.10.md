# Mise √† jour vers la v1.10 de la v1.9

## Nouvelles fonctionnalit√©s int√©ressantes üéâ

- [Ajouter des facades.Crypt(1.10.0)](#encryption)
- [Ajouter des facades.Hash(1.10.0)](#hashing)
- [Ajouter une limite de taux pour routage (1.10.0)](#add-rate-limiting-for-routing)

## Am√©liorations üöÄ

- [Mise √† niveau vers la v1.10 de la v1.9](#upgrading-to-v110-from-v19)
  - [Nouvelles fonctionnalit√©s int√©ressantes üéâ](#exciting-new-features-)
  - [Am√©liorations :fus√©e:](#enhancements-)
  - [Changements de bris üõ†Ô∏è](#breaking-changes-)
  - [Guide de mise √† niveau](#upgrade-guide)
    - [Mise √† jour des d√©pendances] (#updating-dependencies)
    - [Encryption](#encryption)
    - [Hashing](#hashing)
    - [Ajouter une limite de taux pour le routage](#add-rate-limiting-for-routing)
    - [Optimiser le mode de d√©marrage HTTP] (#optimize-http-startup-mode)
    - [Optimiser le mode de d√©marrage GRPC](#optimize-grpc-startup-mode)
    - (#add-configuration-to-control-log-output-to-console)
    - (#request-modify-and-add-methods)
    - [Prise en charge de la file d'attente retard√©e de l'exp√©dition](#queue-support-delayed-dispatching)
    - [La connexion dans l'ORM prend en charge le pr√©fixe de table d√©fini et le singulier](#the-connection-in-orm-supports-set-table-prefix-and-singular)
    - [Ajouter un fichier docker-compose.yml](#add-docker-composeyml-file)
    - [Optimiser l'orme](#optimize-orm)
    - [Support de plusieurs SQL dans le fichier de migration](#support-multiple-sql-in-migration-file)
    - [Ajouter un pilote minio pour le stockage de fichiers](#add-minio-driver-for-file-storage)
    - [Contrats/http add status mapping of net/http](#contractshttp-add-status-mapping-of-nethttp)
    - [APP\_KEY requis](#app_key-required)
    - [Ajouter le param√®tre ctx aux m√©thodes sous Form Request](#add-ctx-parameter-to-the-methods-under-form-request)
    - [facades.Auth.Parse add payload returns](#facadesauthparse-add-payload-returns)
    - [Quelques m√©thodes d‚Äôorme ajoutent de nouvelles valeurs de retour](#some-methods-of-orm-add-new-return-values)

## Changements en cours :hammer_and_wclch:

- [APP_KEY required(1.10.0)](#app-key-required)
- [Ajouter le param√®tre ctx aux m√©thodes sous Form Request(1.10.0)](#add-ctx-parameter-to-the-methods-under-form-request)
- [facades.Auth.Parse ajoute les retours de la charge utile (1.10.0)](#facades-auth-parse-add-payload-returns)
- [Quelques m√©thodes d'Orm ajoutent de nouvelles valeurs retourn√©es (1.10.0)](#some-methods-of-orm-add-new-return-values)

## Guide de mise √† jour

**Temps d'am√©lioration estim√© : 20 minutes**

### Mise √† jour des d√©pendances

Mettre √† jour les d√©pendances dans le fichier `go.mod` :

```
go get -u github.com/goravel/framework@v1.10.0 && go mod tidy
```

### Chiffrement

Version : v1.10.0

Ajouter `facades.Crypt`:

1. ajouter `&crypt.ServiceProvider{}` √† l'√©l√©ment `providers` dans
  le fichier [config/app.go](https://github.com/goravel/goravel/blob/v1.10.x/config/app.go) ;

[Pour le d√©tail](../security/encryption)

### Hachage

Version : v1.10.0

Ajouter `facades.Hash`:

1. ajouter `&hash.ServiceProvider{}` √† l'√©l√©ment `providers` dans
  le fichier [config/app.go](https://github.com/goravel/goravel/blob/v1.10.x/config/app.go) ;

2. Ajouter un fichier [config/hashing.go](https://github.com/goravel/goravel/blob/v1.10.x/config/hashing.go) ;

[Pour le d√©tail](../security/hashing)

### Ajouter une limite de taux pour le routage

Version : v1.10.0

[Pour le d√©tail](../basic/routing#Rate-Limiting)

### Optimiser le mode de d√©marrage HTTP

Version : v1.10.0

1. Ajouter la configuration `config/http.go`, [For Detail](https://github.com/goravel/goravel/blob/v1.10.x/config/http.go);
2. The `facades.Route.Run` method no longer needs to pass parameters, by default use `http.host` and `http.port`(you
  don't need to modify the code, it's backward compatible);
3. La m√©thode `facades.Route.RunTLS` n'a plus besoin de passer des param√®tres, par d√©faut utilisez `http.tls.host`,
  `http. ls.port`, `http.tls.ssl.cert` et `http.tls.ssl.key`, si vous l'utilisez, vous devez modifier le code;
4. Ajouter la m√©thode `facades.Route.RunTLSWithCert`, [For Detail](../basic/routing#start-server);
5. D√©placer `app.url`, `app.host` vers `http.url`, `http.host`;

### Optimiser le mode de d√©marrage GRPC

Version : v1.10.0

The `facades.Grpc.Run` method no longer needs to pass parameters, by default use `grpc.host` and `grpc.port`(you don't
need to modify the code, it's backward compatible);

### Ajouter la configuration pour contr√¥ler la sortie du journal dans la console

Version : v1.10.0

Ajoute la configuration `print` √† `single`, le canal `daily` dans le fichier `config/logging.go`, il peut contr√¥ler la sortie du journal vers la console
, [For Detail](https://github.com/goravel/goravel/blob/v1.10.x/config/logging.go);

### Demander des modifications et ajouter des m√©thodes

Version : v1.10.0

1. La m√©thode `Input` est modifi√©e pour ne r√©cup√©rer que les param√®tres de routage et r√©cup√©rer les donn√©es selon l'ordre suivant :
  `json`, `form`, `query`, `route`<unk> Note: `json` peut seulement obtenir des donn√©es unidimensionnelles, sinon il retournera vide;
2. Ajoute la m√©thode `Route` pour remplacer la m√©thode originale `Input`;
3. La valeur par d√©faut des m√©thodes `Query` et `Form` sont modifi√©es pour √™tre inutiles;
4. Ajouter des m√©thodes comme indiqu√© ci-dessous:

| M√©thode    | Action                                                                                                          |
| ---------- | --------------------------------------------------------------------------------------------------------------- |
| Itin√©raire | [R√©cup√©ration d'une valeur de route](../basic/requests#Retrieving-An-Input-Value)                               |
| RouteInt   | [R√©cup√©ration d'une valeur de route](../basic/requests#Retrieving-An-Input-Value)                               |
| RouteInt64 | [R√©cup√©ration d'une valeur de route](../basic/requests#Retrieving-An-Input-Value)                               |
| Requ√™teInt | [R√©cup√©ration de l'entr√©e dans la cha√Æne de requ√™tes](../basic/requests#Retrieving-Input-From-The-Query-String) |
| QueryInt64 | [R√©cup√©ration de l'entr√©e dans la cha√Æne de requ√™tes](../basic/requests#Retrieving-Input-From-The-Query-String) |
| QueryBool  | [R√©cup√©ration de l'entr√©e dans la cha√Æne de requ√™tes](../basic/requests#Retrieving-Input-From-The-Query-String) |
| InputInt   | [R√©cup√©ration d'une valeur d'entr√©e](../basic/requests#Retrieving-An-Input-Value)                               |
| InputInt64 | [R√©cup√©ration d'une valeur d'entr√©e](../basic/requests#Retrieving-An-Input-Value)                               |
| InputBool  | [R√©cup√©ration d'une valeur d'entr√©e](../basic/requests#Retrieving-An-Input-Value)                               |
| Json       | [R√©cup√©ration de Json](../basic/requests#Retrieving-Json)                                                       |

### La prise en charge de la file d'attente a retard√© l'envoi

Version : v1.10.0

Ajouter la m√©thode `Delay`, [For Detail](../advanced/queues#Delayed-Dispatching)

### La connexion dans ORM prend en charge le pr√©fixe de table et singulier

Version : v1.10.0

1. `Model` supporte sp√©cifier le nom de la table, [For Detail](../orm/quickstart);
2. Ajoute de nouvelles cl√©s √† `connection` de `config/database.go`:

`prefix`: D√©finit le pr√©fixe pour le nom de la table;
`singular`: d√©finit le nom de la table √† utiliser au singulier ou au pluriel;

[Pour le d√©tail](https://github.com/goravel/goravel/blob/v1.10.x/config/database.go)

### Ajouter un fichier docker-compose.yml

Version : v1.10.0

Vous pouvez rapidement d√©marrer le service avec la commande suivante :

```
docker-compose la version
docker-compose vers le haut
```

### Optimiser orme

Version : v1.10.0

1. Ajouter les m√©thodes suivantes :

| Fonctions              | Action                                                                                                                               |
| ---------------------- | ------------------------------------------------------------------------------------------------------------------------------------ |
| Premier ou             | [Requ√™te ou retour de donn√©es via callback] (#Query-one-line) |
| Premier ou nouveau     | [R√©cup√©ration ou de nouveaux mod√®les](#Retrieving-Or-Creating-Models)                                                                |
| Premier ou √©chec       | [Erreur non trouv√©e](#Not-Found-Error)                                                                                               |
| Mettre √† jour ou cr√©er | [Mettre √† jour ou cr√©er](#Update-or-create)                                                                                          |

2. Une erreur a d√©j√† √©t√© signal√©e de la sorte, mais maintenant elle est support√©e :

```go
query := facades.Orm.Query()
query = query.Where()
```

### Soutenir plusieurs SQL dans le fichier de migration

Version : v1.10.0

Auparavant, une seule requ√™te SQL √©tait prise en charge dans le fichier de migration, mais maintenant plusieurs requ√™tes sont support√©es.

### Ajouter un pilote minio pour le stockage de fichiers

Version : v1.10.0

Ajouter une configuration minio, [Pour le d√©tail](https://github.com/goravel/goravel/blob/v1.10.x/config/filesystems.go).

### Contrats/http Ajouter le mapping de statut du net/http

Version : v1.10.0

Vous pouvez utiliser des codes de statut tels que `http.StatusOK` directement dans le contr√¥leur sans importer `net/http`.

[Pour le d√©tail](https://github.com/goravel/framework/blob/v1.10.0/contracts/http/status.go)

### La cl√© de l'application est requise

Version : v1.10.0

Le fichier `APP_KEY` dans le fichier `.env` est modifi√©, vous pouvez ex√©cuter la commande pour g√©n√©rer le APP_KEY:
`go run . cl√© artisanale:generate`.

### Ajouter le param√®tre ctx aux m√©thodes sous la requ√™te de formulaire

Version : v1.10.0

Ajoutez le param√®tre `ctx http.Context` aux m√©thodes sous Form Request: `Rules`, `Messages`, `Attributes`,
`PrepareForValidation`, vous permet de faire plus de configurations personnalis√©es.

[Pour le d√©tail](../basic/validation#creating-form-requests)

### facades.Auth.Parse add payload returns

Version : v1.10.0

`err := facades.Auth.Parse(ctx, token)` changer en `payload, err := facades.Auth.Parse(ctx, token)`, via `payload`
vous pouvez obtenir:

1. `Guard`: Garde actuelle;
2. `Key` : Drapeau utilisateur ;
3. `ExpireAt`: Expire le temps;
4. `IssuedAt`: Heure d'√©mission ;

[Pour le d√©tail](../security/authentication#parse-token)

### Certaines m√©thodes d'Orm ajoutent de nouvelles valeurs de retour

Version : v1.10.0

Les m√©thodes suivantes ajoutent la valeur de retour `*Result` pour obtenir le nombre de lignes affect√©es :

```go
res, err := query.Delete(&user)
res, err := query.Exec(fmt.Sprintf("DELETE FROM utilisateurs o√π id = %d", user.ID))
res, err := requ√™te. orceDelete(&User{})
res, err := query.Updates(User{Avatar: "avatar"})

// Lignes affect√©es
num := res.RowsAffected
```
