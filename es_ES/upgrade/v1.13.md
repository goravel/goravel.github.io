# Actualizar a v1.13 desde v1.12

### Excitantes nuevas caracter√≠sticas üéâ

- [Seeding](#seeding)
- [Factories](#factories)
- [Testing](#testing)
- [Views](#views)

## Mejoras üöÄ

- [Actualizar la versi√≥n predeterminada de Golang a 1.20](#upgrade-the-default-version-of-golang-to-1-20)
- [Tarea de programaci√≥n soporta escalas horizontales](#schedule-supports-scale-horizontally)
- [A√±adir m√©todos de depuraci√≥n](#add-debug-methods)
- [make:controller Command Add Parameter](#make-controller-command-adds-parameter)
- [Agregar m√©todo de estado para respuesta](#add-status-method-for-response)
- [A√±adir M√©todos de Suma y Cursor para Orm](#add-sum-and-cursor-methods-for-orm)
- [El M√≥dulo de Ruta soporta configurar el Driver](#the-route-module-supports-configure-driver)
- [A√±adir M√©todos de InputArray e InputMap para Solicitar](#add-inputarray-and-inputmap-methods-for-request)
- [El modelo de orm soporta conexi√≥n personalizada](#the-model-of-orm-supports-custom-connection)
- [A√±adir controlador nublado para archivos](#add-cloudinary-driver-for-filesystem)
- [A√±adir nuevos m√©todos de cadena para el registro](#add-new-chain-methods-for-log)

### v1.13.4

- [El servicio de inicio soporta variables de entorno](#the-service-startup-supports-environment-variables)

## Cambios de ruptura üõ†Ô∏è

- [Eliminar el Middleware HTTP global cargado por defecto](#_5-remove-the-global-http-middleware-loaded-by-default)
- [Optimizar el retorno del controlador](#_6-optimize-the-return-of-controller)
- [Cambiar el par√°metro del m√©todo de grupo en facades.Route()](#_7-change-the-parameter-of-the-group-method-in-facades-route)
- [Optimizar M√©todos de Recuerda y Recuerda en fachades.Cache()(Si est√° usando)](#_8-optimize-remember-and-rememberforever-methods-in-facades-cache-if-using)
- [Cambiar el nombre del paquete de access.NewAllowResponse y access.NewDenyResponse(Si est√° usando)](#_9-change-the-package-name-of-access-newallowresponse-and-access-newdenyresponse-if-using)
- [Eliminar M√©todos Obsoletos(Si se usa)](#_10-remove-deprecated-methods-if-using)

### Corregir errores üêõ

- [Corregir facades.Auth() ser()](#fix-facades-auth-user)
- [Corregir la ruta .env personalizada no toma efecto en algunos casos](#fix-custom-env-path-does-not-take-effect-in-some-cases)
- [Fix Token expira inmediatamente cuando ttl == 0 est√° configurado en JWT](#fix-token-expires-immediately-when-ttl-0-is-set-in-jwt)

#### v1.13.2

- [Corregir facades.Storage())[video] rl() Devuelve la ruta incorrecta bajo Windows](#fix-facades-storage-url-returns-wrong-path-under-windows)
- [Corregir conexi√≥n anormal cuando la contrase√±a de Postgres est√° vac√≠a](#fix-abnormal-connection-when-the-postgres-password-is-empty)
- [Corregir el M√©todo con el M√©todo es inv√°lido al usar el M√©todo Cursor de Orm](#fix-the-with-method-is-invalid-when-using-the-cursor-method-of-orm)

#### v1.13.4

- [Corregir el m√≥dulo de validaci√≥n no verifica los par√°metros de la ruta](#fix-the-validation-module-cant-verify-the-route-params)
- [Corregir el archivo de retorno del conductor de fibra](#fix-the-fiber-driver-cant-return-file)
- [Corregir el Middleware Global del Panel de Controlador de Fibra](#fix-the-global-middleware-of-fiber-driver-panic)
- [Corregir el ajuste Tipo de Contenido del controlador de fibra es diferente del conductor de ginas](#fix-the-contenttype-setting-of-fiber-driver-is-different-from-gin-driver)

#### v1.13.5

- [Corregir la conexi√≥n del modelo no funciona](#fix-the-connection-of-model-does-not-work)
- [Corregir el error del registro simulado](#fix-the-error-of-mock-log)

#### v1.13.6 v1.13.7

- [Corregir el problema de la ejecuci√≥n no lineal de la cadena de consultas](#fix-the-problem-of-nonlinear-execution-of-query-chain)

#### v1.13.8

- [Corregir el problema de facades.Auth().Parse()](#fix-the-problem-of-facades-auth-parse)
- [Corregir el problema de las facades.Orm().WithContext()](#fix-the-problem-of-facades-orm-withcontext)
- [El registro de cola est√° controlado por APP_DEBUG](#the-queue-log-is-controlled-by-app-debug)

#### v1.13.9

- [Corregir el problema de la nueva impresi√≥n de l√≠nea de registro es incorrecta](#fix-the-problem-of-the-new-line-print-of-log-is-incorrect)
- [Corregir el problema del vendedor:publicar Commabnd no puede publicar directorio](#fix-the-problem-of-the-vendor-publish-commabnd-can-not-publish-directory)

### v1.13.10

- [Corregir los rastros no limpiados al llamar a Log.Info despu√©s de Log.Error](#fix-the-traces-do-not-cleaned-when-calling-log-info-after-log-error)
- [Corregir el GetAttributo de Orm Event Devuelve Datos de Error](#fix-the-getattribute-of-orm-event-returns-error-data)
- [A√±adir m√©todos ToSql, ToRawSql para ORM](#add-tosql-torawsql-methods-for-orm)

## Actualizar Gu√≠a

Por favor, actualice el framework paso a paso seg√∫n el contenido de esta secci√≥n.

**Tiempo estimado de mejora: 10 minutos**

### 1. Actualizando dependencias

Actualizar dependencias en el archivo `go.mod`:

```
go get -u github.com/goravel/framework@v1.13.9 && go get -u github.com/goravel/gin
```

### 2. A√±adir nuevos archivos

[tests](https://github.com/goravel/goravel/tree/v1.13.x/tests)

[database/seeders/database_seeder.go](https://github.com/goravel/goravel/tree/v1.13.x/database/seeders/database_seeder.go)

[app/providers/database_service_provider.go](https://github.com/goravel/goravel/tree/v1.13.x/app/providers/database_service_provider.go)

### 3. Registrar nuevos proveedores

Tenga en cuenta el pedido:

```go
import (
  "github.com/goravel/framework/testing"
  "github.com/goravel/gin"
)

// config/app. o
"providers": []foundation.ServiceProvider{
  ...
  &validation.ServiceProvider{},
  // Nuevo
  &testing. erviceProvider{}, 
  &providers.AppServiceProvider{},
  ...
  &providers. alidationServiceProvider{},
  // Nuevo
  &providers.DatabaseServiceProvider{}, 
  // Nuevo
  &gin.ServiceProvider{}, 
}
```

### 4. A√±adir configuraci√≥n

Modificar [config/http.go](https://github.com/goravel/goravel/tree/v1.13.x/config/http.go)

```go
import (
  "github.com/goravel/framework/contracts/route"
  "github.com/goravel/framework/facades"
  ginfacades "github.com/goravel/gin/facades"
)

config.Add("http", map[string]any{
  // HTTP Driver
  "default": "gin",
  // HTTP Drivers
  "drivers": map[string]any{
    "gin": map[string]any{
      "route": func() (route.Route, error) {
        return ginfacades.Route("gin"), nil
      },
    },
  },
  ...
}
```

Modificar [config/cors.go](https://github.com/goravel/goravel/tree/v1.13.x/config/cors.go)

```go
config.Add("cors", map[string]any{
  ...
  // New
  "paths": []string{"*"}, 
  "allowed_methods": []string{"*"},
  ...
}
```

### 5. Eliminar el Middleware Global HTTP cargado por defecto

1. El middleware `tls` y `cors` han sido integrados en el controlador HTTP predeterminado, por lo tanto, `middleware. ors()` y
  `middleware.Tls()` en el archivo `app/http/kernel.go` necesitan ser removidos.

2. El m√©todo `facades.Route().GlobalMiddleware(http.Kernel{}.Middleware()...)` en el archivo
  `app/providers/route_service_provider.go` se mueve a `Boot` desde `Register`:

```go
proveedores de paquetes

...

type RouteServiceProvider struct {
}

func (receptor *RouteServiceProvider) Register(fundaci√≥n de aplicaciones. pplicaci√≥n) {
}

func (receptor *RouteServiceProvider) Boot(fundaci√≥n de aplicaciones. pplication) {
  //A√±adir middleware HTTP
  facades.Route().GlobalMiddleware(http.Kernel{}.Middleware()...)

  receptor. onfigureRateLimiting()

  routes.Web()
}

func (receptor *RouteServiceProvider) configureRateLimiting() {

}
```

### 6. Optimizar el retorno del controlador

`Controller` a√±ade valor de retorno `http.Response`, `ctx.Response()` puede ser devuelto directamente, no hay necesidad de usar
`return` por separado para hacer la l√≥gica m√°s suave.

```go
// Antes de
func (r *UserController) Show(ctx http.Context) {
  ctx.Response().Success().Json(http. son{
    "Hello": "Goravel",
  })
  return
}

// Despu√©s de la func
(r *UserController) Show(ctx http. ontext) http.Response {
  return ctx.Response().Success().Json(http.Json{
    "Hola": "Goravel",
  })
}
```

### 7. Cambiar el par√°metro del m√©todo de grupo en facades.Route()

Cambia `route.Route` a `route.Router`Ôºö

```go
// Antes de
facades.Route().Group(func(route route.Route)

// Despu√©s de
facades.Route().Group(func(route route.Router)
```

### 8. Optimizar recordar y recordar m√©todos en facades.Cache()(Si usa)

El tipo de `callback` cambia a `func() (any, error)` de `func() any`:

```go
// Antes de
Recuerda (cadena de clave, tiempo ttl. uration, callback func() any) (any, error)
recuerde (key string, callback func() any) (any, error)

// Despu√©s de
Recuerda (cadena clave, tiempo ttl. uration, callback func() (any, error)) (any, error)
Recuerde (cadena clave, funci√≥n callback () (ninguno, error)) (ninguno, error) (ninguno)
```

### 9. Cambiar el nombre del paquete de access.NewAllowResponse y access.NewDenyResponse(Si se usa)

Cambia `/contracts/auth/access` a `/auth/access`:

```go
// Before
import "github.com/goravel/framework/contracts/auth/access"

access.NewAllowResponse()
access.NewDenyResponse()

// After
import "github.com/goravel/framework/auth/access"

access.NewAllowResponse()
access.NewDenyResponse()
```

### 10. Eliminar m√©todos obsoletos (si se usa)

1. Remueve los m√©todos `ctx.Request().Form()` y `ctx.Request().Json()`, use el m√©todo `ctx.Request().Input()`;

2. Elimina `GetLevel`, `GetTime`, `GetMessage` m√©todos personalizados de `Log`, utiliza `Level`, `Time`, `Message` m√©todos
  en su lugar;

3. Remueve el m√©todo `gorm.New`, el m√©todo se utiliza para obtener directamente la instancia `gorm`, ya no se recomienda.
  si es necesario, utilice el m√©todo `gorm.NewGormImpl` en su lugar;

## Introducci√≥n de la funci√≥n

### Sembrando

Versi√≥n: v1.13.1

[Para m√°s informaci√≥n](../orm/seeding)

### F√°bricas

Versi√≥n: v1.13.1

[Para m√°s informaci√≥n](../orm/factories)

### Pruebas

Versi√≥n: v1.13.1

[Para m√°s informaci√≥n](../testing/quickstart)

### Vistas

Versi√≥n: v1.13.1

[Para m√°s informaci√≥n](../basic/views)

### Actualizar la versi√≥n predeterminada de Golang a 1.20

Versi√≥n: v1.13.1

Golang 1.18 y 1.19 han sido interrumpidos y el framework ha sido actualizado a 1.20
en consecuencia, [para m√°s detalles](https://endoflife.date/go). Si desea continuar usando 1.18 o 1.19, simplemente modifique el n√∫mero de versi√≥n
en `go.mod`, son totalmente compatibles actualmente.

### La programaci√≥n de tareas soporta escalar horizontalmente

Versi√≥n: v1.13.1

[Para m√°s informaci√≥n](../advanced/schedule#running-tasks-on-one-server)

### A√±adir m√©todos de depuraci√≥n

Versi√≥n: v1.13.1

[Para m√°s informaci√≥n](../advanced/helpers#debug)

### make:controlador a√±ade par√°metro de comando

Versi√≥n: v1.13.1

El comando `make:controller` a√±ade el par√°metro `--resource`, la estructura CURD se puede crear f√°cilmente:

```
go run . artisan make:controller --resource UserController
```

### A√±adir m√©todo de estado para la respuesta

Versi√≥n: v1.13.1

[Para m√°s informaci√≥n](../basic/responses#custom-code)

### A√±adir m√©todos Sum y Cursor para Orm

Versi√≥n: v1.13.1

[Para m√°s informaci√≥n](../orm/quickstart#facades-orm-query-facades-orm-transaction-available-functions)

### El M√≥dulo de Ruta admite configurar el controlador

Versi√≥n: v1.13.1

Separe el controlador original Gin del m√≥dulo Ruta en un paquete, puede ser inyectado en Goravel mediante la configuraci√≥n
. despu√©s de esta optimizaci√≥n, los proveedores de un canal conveniente para inyectar otros paquetes HTTP en Goravel,
actualmente dos paquetes HTTP son soportados oficialmente:

| Conductor | Enlace                                                                                               |
| --------- | ---------------------------------------------------------------------------------------------------- |
| Gin       | [https://github.com/goravel/gin](https://github.com/goravel/gin)     |
| Fibra     | [https://github.com/goravel/fiber](https://github.com/goravel/fiber) |

### A√±adir m√©todos de entrada y matriz de entrada para la solicitud

Versi√≥n: v1.13.1

[Para m√°s informaci√≥n](../basic/requests#retrieving-an-input-value)

### El modelo de orm soporta conexi√≥n personalizada

Versi√≥n: v1.13.1

[Para m√°s informaci√≥n](../orm/quickstart#database-connections)

### A√±adir controlador nublado al sistema de archivos

Versi√≥n: v1.13.1

[Para m√°s informaci√≥n](https://github.com/goravel/cloudinary)

### A√±adir nuevos m√©todos de cadena para el registro

Versi√≥n: v1.13.1

[Para m√°s informaci√≥n](../basic/logging#chain-methods)

### Corregir facades.Auth())[video] ser()

Versi√≥n: v1.13.1

1. Corregir el problema que no arroja ning√∫n error si el usuario no exist√≠a al usar el m√©todo `facades.Auth())[video] ser(ctx, &user)`
  .

2. Corregir el problema de que `usuario` se puede encontrar cuando la clave principal no es `int`;

### Corregir ruta .env personalizada no tiene efecto en algunos casos

Versi√≥n: v1.13.1

Corregir el problema que la ruta .env personalizado no tiene efecto en algunos casos.

### Fijar la ficha caduca inmediatamente cuando ttl == 0 est√° configurado en JWT

Versi√≥n: v1.13.1

Espere que el token nunca expire cuando `ttl == 0`.

### Corregir facades.Storage())[video] rl() Devuelve Ruta incorrecta bajo Windows

Versi√≥n: v1.13.2

[Problema #263](https://github.com/goravel/goravel/issues/263)

### Corregir conexi√≥n anormal cuando la contrase√±a de Postgres est√° vac√≠a

Versi√≥n: v1.13.2

[Problema #270](https://github.com/goravel/goravel/issues/270)

### Corregir el m√©todo con un m√©todo no v√°lido cuando se utiliza el m√©todo cursor de orm

Versi√≥n: v1.13.2

[Problema #253](https://github.com/goravel/goravel/issues/253)

### El arranque del servicio soporta variables de entorno

Versi√≥n: v1.13.4

[Problema #265](https://github.com/goravel/goravel/issues/265)

### Corregir el m√≥dulo de validaci√≥n de cante verifica los par√°metros de ruta

goravel/gin: v1.1.6

goravel/fiber: v1.1.11

[Problema #294](https://github.com/goravel/goravel/issues/294)

### Corregir el archivo de retorno del conductor de fibra

goravel/fiber: v1.1.11

[Problema #299](https://github.com/goravel/goravel/issues/299)

### Corregir el Middleware Global del P√°nico del Conductor de Fibras

goravel/fiber: v1.1.11

[Problema #300](https://github.com/goravel/goravel/issues/300)

### Corregir la configuraci√≥n de tipo de contenido del controlador de fibra es diferente del controlador de ginebra

goravel/fiber: v1.1.11

[Problema #296](https://github.com/goravel/goravel/issues/296)

### Corregir la conexi√≥n del modelo no funciona

goravel/framework: v1.13.5

[Problema #312](https://github.com/goravel/goravel/issues/312)

### Corregir el error del registro simulado

goravel/framework: v1.13.5

[Problema #320](https://github.com/goravel/goravel/issues/320)

### Corregir el problema de la ejecuci√≥n no lineal de la cadena de consultas

goravel/framework: v1.13.6 v1.13.7

[Problema #341](https://github.com/goravel/goravel/issues/341)

### Corregir el problema de facades.Auth().Parse()

goravel/framework: v1.13.8

[Problema #388](https://github.com/goravel/goravel/issues/388)

### Corregir el problema de facades.Orm().WithContext()

goravel/framework: v1.13.8

[Problema #390](https://github.com/goravel/goravel/issues/390)

### El registro de cola est√° controlado por APP_DEBUG

goravel/framework: v1.13.8

Los niveles de `Debug` e `Info` no se imprimir√°n cuando `APP_DEBUG=false`

[Problema #389](https://github.com/goravel/goravel/issues/389)

### Corregir el problema de la nueva l√≠nea de impresi√≥n de registro es incorrecta

goravel/framework: v1.13.9

[Problema #395](https://github.com/goravel/goravel/issues/395)

### Corregir el problema del vendedor:publicar Commabnd no puede publicar el directorio

goravel/framework: v1.13.9

[Problema #345](https://github.com/goravel/goravel/issues/345)

### Corregir las huellas no limpiadas al llamar a Log.Info despu√©s de Log.Error

goravel/framework: v1.13.10

[Problema #402](https://github.com/goravel/goravel/issues/402)

### Corregir el GetAttributo de Orm Event Devuelve Datos de Error

goravel/framework: v1.13.10

[Problema #405](https://github.com/goravel/goravel/issues/405)

### A√±adir m√©todos ToSql, ToRawSql para ORM

goravel/framework: v1.13.10

[Problema #411](https://github.com/goravel/goravel/issues/411)
