# Actualizar a v1.10 desde v1.9

## Excitantes nuevas caracter√≠sticas üéâ

- [A√±adir fachades.Crypt(1.10.0)](#encryption)
- [A√±adir facades.Hash(1.10.0)](#hashing)
- [Agregar l√≠mite de tasa para enrutamiento(1.10.0)](#add-rate-limiting-for-routing)

## Mejoras üöÄ

- [Actualizar a v1.10 desde v1.9](#upgrading-to-v110-from-v19)
  - [Excitantes nuevas caracter√≠sticas üéâ](#exciting-new-features-)
  - [Mejoras üöÄ](#enhancements-)
  - [Rompiendo Cambios üõ†Ô∏è](#breaking-changes-)
  - [Mejorar Gu√≠a](#upgrade-guide)
    - [Actualizando dependencias](#updating-dependencies)
    - [Encryption](#encryption)
    - [Hashing](#hashing)
    - [Agregar l√≠mite de tasa para enrutamiento](#add-rate-limiting-for-routing)
    - [Optimizar modo de inicio HTTP](#optimize-http-startup-mode)
    - [Optimizar modo de inicio GRPC](#optimize-grpc-startup-mode)
    - [A√±adir configuraci√≥n para controlar salida de registro a la consola](#add-configuration-to-control-log-output-to-console)
    - [Solicitar modificar y a√±adir m√©todos](#request-modify-and-add-methods)
    - [Soporte de cola de env√≠o retrasado](#queue-support-delayed-dispatching)
    - [La conexi√≥n en ORM soporta el prefijo de la tabla y singular](#the-connection-in-orm-supports-set-table-prefix-and-singular)
    - [A√±adir archivo docker-compose.yml](#add-docker-composeyml-file)
    - [Optimizar Orm](#optimize-orm)
    - [Soporte m√∫ltiples SQL en el archivo de migraci√≥n](#support-multiple-sql-in-migration-file)
    - [A√±adir minio controlador para el almacenamiento de archivos](#add-minio-driver-for-file-storage)
    - [contracts/http add status mapeo de estado de net/http](#contractshttp-add-status-mapping-of-nethttp)
    - [APP\_KEY requerido](#app_key-required)
    - [A√±adir par√°metro ctx a los m√©todos bajo Solicitud de Formulario](#add-ctx-parameter-to-the-methods-under-form-request)
    - [facades.Auth.Anse add payload returns](#facadesauthparse-add-payload-returns)
    - [Algunos m√©todos de Orm agregan nuevos valores de retorno](#some-methods-of-orm-add-new-return-values)

## Cambios de ruptura üõ†Ô∏è

- [APP_KEY requerido(1.10.0)](#app-key-required)
- [A√±adir par√°metro ctx a los m√©todos bajo Form Request(1.10.0)](#add-ctx-parameter-to-the-methods-under-form-request)
- [facades.Auth.Parse a√±ade payload returns(1.10.0)](#facades-auth-parse-add-payload-returns)
- [Algunos m√©todos de Orm a√±adir nuevos valores de devoluci√≥n(1.10.0)](#some-methods-of-orm-add-new-return-values)

## Actualizar Gu√≠a

**Tiempo estimado de mejora: 20 minutos**

### Actualizando dependencias

Actualizar dependencias en el archivo `go.mod`:

```
go get -u github.com/goravel/framework@v1.10.0 && go mod tidy
```

### Encriptaci√≥n

Versi√≥n: v1.10.0

A√±ade `facades.Crypt`:

1. a√±ade `&crypt.ServiceProvider{}` al elemento `providers` en
  el archivo [config/app.go](https://github.com/goravel/goravel/blob/v1.10.x/config/app.go)

[Para m√°s informaci√≥n](../security/encryption)

### Hashing

Versi√≥n: v1.10.0

A√±adir `facades.Hash`:

1. a√±ade `&hash.ServiceProvider{}` al elemento `providers` en
  el archivo [config/app.go](https://github.com/goravel/goravel/blob/v1.10.x/config/app.go)

2. A√±adir [config/hashing.go](https://github.com/goravel/goravel/blob/v1.10.x/config/hashing.go) archivo;

[Para m√°s informaci√≥n](../security/hashing)

### A√±adir l√≠mite de tasa para ruta

Versi√≥n: v1.10.0

[Para m√°s informaci√≥n](../basic/routing#Rate-Limiting)

### Optimizar modo de inicio HTTP

Versi√≥n: v1.10.0

1. A√±adir configuraci√≥n `config/http.go`, [Para m√°s detalles](https://github.com/goravel/goravel/blob/v1.10.x/config/http.go);
2. El m√©todo `facades.Route.Run` ya no necesita pasar par√°metros, por defecto usa `http.host` y `http.port`(t√∫
  no necesitas modificar el c√≥digo, es compatible con versiones anteriores);
3. El m√©todo `facades.Route.RunTLS` ya no necesita pasar par√°metros, por defecto use `http.tls.host`,
  `http. ls.port`, `http.tls.ssl.cert` y `http.tls.ssl.key`, si lo est√°s usando, necesitas modificar el c√≥digo;
4. A√±ade el m√©todo `facades.Route.RunTLSWithCert`, [Para m√°s detalles](../basic/routing#start-server);
5. Mueve `app.url`, `app.host` a `http.url`, `http.host`;

### Optimizar el modo de inicio GRPC

Versi√≥n: v1.10.0

El m√©todo `facades.Grpc.Run` ya no necesita pasar par√°metros, por defecto use `grpc.host` y `grpc.port`(no necesitas
modificar el c√≥digo, es compatible con versiones anteriores);

### A√±adir configuraci√≥n para controlar la salida de log a la consola

Versi√≥n: v1.10.0

A√±ade la configuraci√≥n de `print` a `single`, canal `daily` en el archivo `config/logging.go`, puede controlar la salida del registro a la consola
, [Para m√°s detalles](https://github.com/goravel/goravel/blob/v1.10.x/config/logging.go);

### Solicitar modificar y a√±adir m√©todos

Versi√≥n: v1.10.0

1. El m√©todo `Input` se cambia de solo obtener par√°metros de enrutamiento a obtener datos de acuerdo al siguiente orden:
  `json`, `form`, `query`, `route`Note: `json` solo puede obtener datos unidimensionales, de lo contrario devolver√° vac√≠o;
2. A√±ade el m√©todo `Route` para reemplazar el m√©todo `Input` original;
3. El valor por defecto de los m√©todos `Query` y `Form` son modificados para que sean innecesarios;
4. A√±adir m√©todos como se muestra a continuaci√≥n:

| M√©todo         | Accin                                                                                                |
| -------------- | ---------------------------------------------------------------------------------------------------- |
| Ruta           | [Recuperando un valor de ruta](../basic/requests#Retrieving-An-Input-Value)                          |
| RouteInt       | [Recuperando un valor de ruta](../basic/requests#Retrieving-An-Input-Value)                          |
| RouteInt64     | [Recuperando un valor de ruta](../basic/requests#Retrieving-An-Input-Value)                          |
| Consulta       | [Obtener entrada de la cadena de consulta](../basic/requests#Retrieving-Input-From-The-Query-String) |
| Consulta Int64 | [Obtener entrada de la cadena de consulta](../basic/requests#Retrieving-Input-From-The-Query-String) |
| QueryBool      | [Obtener entrada de la cadena de consulta](../basic/requests#Retrieving-Input-From-The-Query-String) |
| InputInt       | [Recuperando un valor de entrada](../basic/requests#Retrieving-An-Input-Value)                       |
| InputInt64     | [Recuperando un valor de entrada](../basic/requests#Retrieving-An-Input-Value)                       |
| InputBool      | [Recuperando un valor de entrada](../basic/requests#Retrieving-An-Input-Value)                       |
| Json           | [Recuperando Json](../basic/requests#Retrieving-Json)                                                |

### Soporte de cola de env√≠o retardado

Versi√≥n: v1.10.0

A√±adir m√©todo `Delay`, [Para Detall](../advanced/queues#Delayed-Dispatching)

### La conexi√≥n en ORM soporta el prefijo de la tabla y singular

Versi√≥n: v1.10.0

1. `Model` soporta el nombre de la tabla especificada, [Para m√°s detalles](../orm/quickstart);
2. A√±ade nuevas claves a `connection` de `config/database.go`:

`prefix`: Establece el prefijo para el nombre de la tabla;
`singular`: Establece el nombre de la tabla para usar singular o plural;

[Para m√°s informaci√≥n](https://github.com/goravel/goravel/blob/v1.10.x/config/database.go)

### A√±adir archivo docker-compose.yml

Versi√≥n: v1.10.0

Puede iniciar el servicio r√°pidamente con el siguiente comando:

```
construcci√≥n de docker-compose
docker-compose up
```

### Optimizar Orm

Versi√≥n: v1.10.0

1. A√±adir los siguientes m√©todos:

| Funciones    | Accin                                                                                                           |
| ------------ | --------------------------------------------------------------------------------------------------------------- |
| O primero    | [Consulta o devuelve datos a trav√©s de callback](#Query-one-line)                                               |
| PrimeroNuevo | [Recuperando o nuevos modelos](#Retrieving-Or-Creating-Models)                                                  |
| FirstOrFail  | [Error no encontrado](#Not-Found-Error)                                                                         |
| Actualizar   | [Actualizar o crear] (#Update-or-create) |

2. Un error fue reportado anteriormente, pero ahora es compatible:

```go
query := facades.Orm.Query()
query = query.Where()
```

### Soporta m√∫ltiples SQL en el archivo de migraci√≥n

Versi√≥n: v1.10.0

Anteriormente, s√≥lo una sentencia SQL fue soportada en el archivo de migraci√≥n, pero ahora se admiten varias sentencias.

### A√±adir minio controlador para el almacenamiento de archivos

Versi√≥n: v1.10.0

A√±adir configuraci√≥n miniatura, [Para m√°s detalles](https://github.com/goravel/goravel/blob/v1.10.x/config/filesystems.go).

### contracts/http a√±adir mapeo de estado de net/http

Versi√≥n: v1.10.0

Puedes usar c√≥digos de estado como `http.StatusOK` directamente en el controlador sin importar `net/http`.

[Para m√°s informaci√≥n](https://github.com/goravel/framework/blob/v1.10.0/contracts/http/status.go)

### Se requiere APP_KEY

Versi√≥n: v1.10.0

El `APP_KEY` en el archivo `.env` se cambia a requerido, puedes ejecutar el comando para generar APP_KEY:
`go run . Clave:generate`.

### A√±adir par√°metro ctx a los m√©todos bajo Form Request

Versi√≥n: v1.10.0

A√±ade el par√°metro `ctx http.Context` a los m√©todos bajo Form Request: `Rules`, `Messages`, `Attributes`,
`PrepareForValidation`, te permite hacer m√°s configuraciones personalizadas.

[Para m√°s informaci√≥n](../basic/validation#creating-form-requests)

### facades.Auth.Parse add payload returns

Versi√≥n: v1.10.0

`err := facades.Auth.Parse(ctx, token)` cambia a `payload, err := facades.Auth.Parse(ctx, token)`, a trav√©s de `payload`
puedes obtener:

1. `Guard`: Guardi√°n Actual;
2. `Clave`: Marca de usuario;
3. `ExpireAt`: Expira el tiempo;
4. `Emitido At`: Tiempo de Emisi√≥n;

[Para m√°s informaci√≥n](../security/authentication#parse-token)

### Algunos m√©todos de Orm a√±aden nuevos valores de retorno

Versi√≥n: v1.10.0

Los siguientes m√©todos a√±aden `*Result` valor de retorno para obtener el n√∫mero de filas afectadas:

```go
res, err := query.Delete(&user)
res, err := query.Exec(fmt.Sprintf("DELETE FROM users where id = %d", user.ID))
res, err := query. orceDelete(&User{})
res, err := queryTechnpdates(User{Avatar: "avatar"})

// Filas afectadas
num := res.RowsAffected
```
