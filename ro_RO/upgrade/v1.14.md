# Actualizare la v1.14 De la v1.13

### FuncÈ›ii noi sunt incredibile ğŸ‰

- [Localization](#localization)
- [Installer](#installer)
- [Cookie](#cookie)
- [Session](#session)

### ÃmbunÄƒtÄƒÈ›iri ğŸš€

- [Suport pentru setarea body_limit È™i header_limit Ã®n Gin È™i Fiber drivers](#support-for-setting-body-limit-and-header-limit-in-gin-and-fiber-drivers)
- [Log add new methods](#log-adds-new-methods)
- [Orm adaugÄƒ metode noi](#orm-adds-new-methods)
- [Console adaugÄƒ metode noi](#console-adds-new-methods)
- [Response add new methods](#response-adds-new-methods)
- [AdaugÄƒ comandÄƒ de construcÈ›ie](#add-build-command)
- [Add helper methods](#add-helper-methods)
- [Driver-ul Redis acceptÄƒ TLS](#redis-driver-supports-tls)

### Ruperea modificÄƒrilor ğŸ› ï¸

- [Validarea nu va lega datele dacÄƒ validarea eÈ™ueazÄƒ](#validation-will-not-bind-data-if-validation-fails)
- [AdÄƒugaÈ›i metode noi È™i modificaÈ›i metodele pentru modulul de testare](#add-new-methods-and-modify-methods-for-testing-module)
- [OptimizaÈ›i metoda de coadÄƒ a e-mailului](#optimize-the-queue-method-of-mail)
- [OptimizaÈ›i metoda de setare a modulului Auth ctx](#optimize-the-setting-method-of-the-auth-module-ctx)
- [OptimizaÈ›i modul de faÈ›ade mocs](#optimize-the-way-of-mock-facades)
- [Framework Orm model add json tag](#framework-orm-model-adds-json-tag)

### v1.14.1

- [ReparÄƒ sesiunea nu este setatÄƒ cu succes Ã®n driver-ul gin ](#fix-the-session-is-not-set-successfully-in-the-gin-driver)
- [RemediaÈ›i fiÈ™ierul de limbÄƒ nu poate fi citit Ã®n modulul de localizare](#fix-the-language-file-cannot-be-read-in-the-localization-module)

### v1.14.2

- [Fix Validation verification of image and file failed](#fix-validation-verification-of-image-and-file-failed)
- [Fix the cookie Expirres set by the goravel/gin driver is invalid](#fix-the-cookie-expires-set-by-the-goravel-gin-driver-is-invalid)

### v1.14.3

Modernizarea ambalajelor Ã®nrudite: goravel/gin: v1.2.2, goravel/fibrÄƒ: v1.2.2

- [Fix Validarea nu poate lega felia](#fix-validation-cannot-bind-slice)
- [Validarea suportÄƒ legarea de carbon](#validation-supports-bind-carbon)

### v1.14.4

ÃmbunÄƒtÄƒÈ›eÈ™te pachetele corespunzÄƒtoare: goravel/gin: v1.2.3

- [Remediere problemÄƒ simultanÄƒ de sesiune](#fix-session-concurrent-problem)
- [Fix Gin set Same_site invalid](#fix-gin-sets-session-same_site-invalid)

### v1.14.5

Modernizarea ambalajelor Ã®nrudite: goravel/gin: v1.2.4, goravel/fibrÄƒ: v1.2.3

- [AdÄƒugare metodÄƒ de oprire pentru rutÄƒ](#add-shutdown-method-for-route)

### v1.14.7

ModernizeazÄƒ pachetele corespunzÄƒtoare: goravel/gin: v1.2.5, goravel/fibrÄƒ: v1.2.4

- [OptimizeazÄƒ metoda ctx.Retragerea HTTP](#optimize-the-ctx-withvalue-method-of-http)

### v1,14,8

- [RemediaÈ›i problema de Ã®nregistrare a ascultÄƒtorilor](#fix-the-problem-of-conflicting-listener-registration)

### v1,14,9

- [RezolvÄƒ problema de personalizare a consolei de tip Log Driver Ã®n mod repetat printare](#fix-the-problem-of-custom-log-driver-console-repeatedly-printing)
- [RemediaÈ›i problema erorii de legare a datelor atunci cÃ¢nd cererea HTTP JSON conÈ›ine o structurÄƒ pe mai multe nivele](#fix-the-problem-of-data-binding-error-when-http-json-request-contains-multi-level-structure)

## Ghid de actualizare

Goravel v1.14 este dezvoltat ÅŸi testat pe baza Golang 1.21 ÅŸi este Ã®n general compatibil cu alte versiuni Golang inferioare.
VÄƒ rugÄƒm sÄƒ actualizaÈ›i framework-ul pas cu pas Ã®n funcÈ›ie de conÈ›inutul din aceastÄƒ secÈ›iune.

**Timp estimat de actualizare: 10 minute**

### 1. Actualizarea dependentelor

```
go get -u github.com/goravel/framework@v1.14.7

// If using gin
go get -u github.com/goravel/gin@v1.2.5

// If using fiber
go get -u github.com/goravel/fiber@v1.2.4

// If using redis
go get -u github.com/goravel/redis@v1.2.1

// If using s3
go get -u github.com/goravel/s3@v1.2.0

// If using oss
go get -u github.com/goravel/oss@v1.2.0

// If using cos
go get -u github.com/goravel/cos@v1.2.0

// If using minio
go get -u github.com/goravel/minio@v1.2.0

// If using cloudinay
go get -u github.com/goravel/cloudinary@v1.2.0

go mod tidy
```

### 2. AdÄƒugarea elementelor de configurare

1. `config/app.go` adaugÄƒ elemente de configurare a modulului de localizare:

```go
"locale": "ro",
"fallback_locale": "en",
"providers": []foundation.ServiceProvider{
  ...
  &session.ServiceProvider{},
  &translation.ServiceProvider{},
  ...
}
```

2. DacÄƒ vrei sÄƒ foloseÈ™ti funcÈ›ia `session`, adaugÄƒ
 fiÈ™ierul [config/session.go](https://github.com/goravel/goravel/blob/master/config/session.go);

### 3) DacÄƒ utilizaÅ£i modulul de validare

ConfirmaÈ›i dacÄƒ Ã®ncÄƒ Ã®ncercaÈ›i sÄƒ citiÈ›i valoarea obligatorie chiar dacÄƒ validarea datelor eÈ™ueazÄƒ. If so, you need to
optimize the logic, because the value is empty after the upgrade.
VedeÈ›i: [Validarea nu va lega datele dacÄƒ validarea eÈ™ueazÄƒ](#validation-will-not-bind-data-if-validation-fails).

### 4. DacÄƒ se utilizeazÄƒ modulul Testare

VerificaÈ›i dacÄƒ utilizaÈ›i metodele `Clear`, `Image`, dacÄƒ da, trebuie sÄƒ modificaÈ›i
Ã®n consecinÈ›Äƒ: [AdÄƒugaÈ›i metode noi È™i modificaÈ›i metodele pentru modulul de testare](#add-new-methods-and-modify-methods-for-testing-module)

### 5. dacÄƒ utilizaÈ›i modulul Mail

VerificaÈ›i dacÄƒ utilizarea metodei `coadÄƒ`, dacÄƒ da, trebuie sÄƒ modificaÈ›i
Ã®n consecinÈ›Äƒ: [OptimizaÈ›i metoda de coadÄƒ pentru e-mail](#optimize-the-queue-method-of-mail)

### 6. DacÄƒ se utilizeazÄƒ modulul Auth

Trebuie sÄƒ modifici
Ã®n consecinÈ›Äƒ: [OptimizeazÄƒ metoda de setare a modulului Auth ctx](#optimize-the-setting-method-of-the-auth-module-ctx)

### 7. DacÄƒ se utilizeazÄƒ faÅ£adele mock

Trebuie modificat Ã®n consecinÈ›Äƒ: [OptimizaÈ›i modul de faÈ›ade mock-uri](#optimize-the-way-of-mock-facades)

### 8. DacÄƒ se utilizeazÄƒ modelul framework Orm È™i se returneazÄƒ datele direct prin punctul final

Necesitatea modificÄƒrii Ã®n consecinÈ›Äƒ: [Modelul Framework Orm adaugÄƒ json tag](#framework-orm-model-adds-json-tag)

## Introducere caracteristicÄƒ

### Localizare

Versiune: v1.14.0

[Vezi documentaÈ›ia](../advanced/localization)

### Instalare

Versiune: v1.14.0

Instalatorul vÄƒ permite sÄƒ descÄƒrcaÈ›i cu uÈ™urinÈ›Äƒ È™i sÄƒ iniÈ›ializaÈ›i un nou proiect Goravel.

[Vezi documentaÈ›ia](http://github.com/goravel/installer)

### Cookie

Versiune: v1.14.0

[Vezi documentaÈ›ia cererii](../basic/requests#cookie)

[Vezi documentaÈ›ia rÄƒspunsului](../basic/responses#cookie)

### Sesiune

Versiune: v1.14.0

[Vezi documentaÈ›ia](../basic/session)

### Suport pentru setarea body_limit È™i header_limit Ã®n modulele-pilot de fibrÄƒ È™i fibrÄƒ

Versiune: v1.14.0

È˜oferii HTTP suportÄƒ setarea body_limit pentru a limita dimensiunea corpului,
vedeÈ›i: [goravel/gin](https://github.com/goravel/gin/blob/c9d7706a6a04c05c8c33af5c97877a1ad2ea6362/README.md?plain=1#L54)
È™i [goravel/fiber](https://github.com/goravel/fiber/blob/aa63ab657cd2b371fcda4df0090a41226f6c0704/README.md?plain=1#L56).

### Log adaugÄƒ metode noi

Versiune: v1.14.0

| MetodÄƒ      | Descrpton                                  |
| ----------- | ------------------------------------------ |
| `Stack`     | UtilizaÈ›i mai multe canale Ã®n acelaÈ™i timp |
| `Channel`   | A fost specificat un canal                 |
| `WithTrace` | TipÄƒreÈ™te urmele                           |

[Vezi documentaÈ›ia](../basic/logging#write-to-a-specific-channel)

### Orm adaugÄƒ metode noi

Versiune: v1.14.0

Add `WhereIn`, `OrWhereIn`, `OrWhereNotIn`, `WhereNotIn`, `WhereBetween`, `WhereNotBetween`, `WhereNull`, `OrWhereNull`,
`OrderByDesc`, `OrderBy`, `InRandomOrder`, `Exists`.

### Consola adaugÄƒ metode noi

Versiune: v1.14.0

[Vezi documentaÈ›ia](../advanced/artisan#prompting-for-input)

### RÄƒspunsul adaugÄƒ noi metode

Versiune: v1.14.0

[Vezi documentaÈ›ia](../basic/responses#no-content)

### AdaugÄƒ comandÄƒ de construcÈ›ie

Versiune: v1.14.0

Proiectul Goravel poate fi compilat cu urmÄƒtoarea comandÄƒ: \`go run . clÄƒdirea artizanalÄƒ".

[Vezi documentaÈ›ia](../quickstart/compile#compile-command)

### AdaugÄƒ metode de ajutor

Versiune: v1.14.0

- [Str](../advanced/strings)
- [Map](../advanced/helpers#maps)
- [Color](../advanced/color)
- [Convert](../advanced/helpers#convert)
- [Collect](../advanced/helpers#collect)

### È˜oferul Redis acceptÄƒ TLS

Versiune: v1.14.0

[Vezi documentaÈ›ia](https://github.com/goravel/redis)

### Validarea nu va lega datele dacÄƒ validarea eÈ™ueazÄƒ

Versiune: v1.14.0

Anterior, atunci cÃ¢nd apeleazÄƒ metodele de mai jos, `userRequest` Ã®ncÄƒ asociazÄƒ valoarea, chiar dacÄƒ eroarea era returnatÄƒ.
DupÄƒ actualizare, nu se va mai lega.

```go
var userRequest requests.UserRequest
erori, err := ctx.Request().ValidateRequest(&userRequest)

// sau
validator, err := validation.Make(***)
err = validator.Bind(&userRequest)
```

### AdÄƒugaÈ›i metode noi È™i modificaÈ›i metodele pentru modulul de testare

Versiune: v1.14.0

1. AdaugÄƒ metoda [Fresh](../testing/quickstart#refresh-database;
2. ModificÄƒ metoda `Clear` la metoda [Stop](../testing/quickstart#uninstall-image);
3. Metoda `Image` adaugÄƒ variabila `ExposedPorts` ÅŸi eliminÄƒ variabila `Timeout`;

```go
Baza de date, err := facades.Testing().Docker().Database()
bazÄƒ de date.Image(testingcontract.Image{
  Repository: "mysql",
  Tag: "5. ",
  Env: []string{
    "MYSQL_ROOT_PASSWORD=123123",
    "MYSQL_DATABASE=goravel",
  },
  -- Timeout: 1000,
  ++ ExpozedPorts: []string{"3306"},
})
```

### OptimizeazÄƒ metoda de coadÄƒ a e-mailului

Versiune: v1.14.0

Parametrul de intrare al metodei `CoadÄƒ` se schimbÄƒ de la `coada *mail.CoadÄƒ` la `coada ...mail.CoadÄƒ`.

```diff
-- facades.Mail().Queue(nil)
++ facades.Mail().CoadÄƒ()

-- facades.Mail().CoadÄƒ (&mail.CoadÄƒ{})
++ facades.Mail().CoadÄƒ (mail.Coada{})
```

### OptimizeazÄƒ metoda de setare a modulului Auth ctx

Versiune: v1.14.0

Anterior, cÃ¢nd apelaÈ›i la `Parse`, `User`, `Login`, `LoginUsingID`, `Refresh`, metode `Logout`, trebuie sÄƒ treceÈ›i de la
`ctx`. DupÄƒ upgrade, nu mai ai nevoie sÄƒ treci `ctx`, Ã®l poÈ›i seta direct Ã®n `facades.Auth(ctx)`.

```diff
-- facades.Auth().Parse(ctx, token)
++ facades.Auth(ctx).Parse(token)

-- facades.Auth().User(ctx, &user)
++ facades.Auth(ctx).User(&user)

-- facades.Auth().Login(ctx, &user)
++ facades.Auth(ctx). ogin(&user)

-- facades.Auth().LoginUsingID(ctx, id)
++ faades.Auth(ctx).LoginUsingID(id)

-- facades.Auth().Refresh(ctx)
++ faades.Auth(ctx).Refresh()

-- facades.Auth().Logout(ctx)
++ facs.Auth(ctx).Logout()
```

### OptimizaÈ›i modul de faÈ›ade mock

Versiune: v1.14.0

```diff
import github.com/goravel/framework/testing/mock

++ mockFactory := mock.Factory()

-- app := mock.App()
++ app := mockFactory. pp()

-- artizan := mock.Artisan()
++ artizan := mockFactory.Artisan()

-- auth := mock. uth()
++ auth := mockFactory.Auth()

-- artizan := mock.Artisan()
++ artizan := mockFactory.Artisan()

-- cache, driver, blocare := mock. ache()
++ cache := mockFactory.Cache()
++ driver := mockFactory.CacheDriver()
++ blocare := mockFactory. acheLock()

-- config := mock.Config()
++ config := mockFactory.Config()

-- crypt := mock.Crypt()
++ cript := mockFactory. rypt()

-- eveniment, sarcinÄƒ := mock.Event()
++ eveniment := mockFactory.Event()
++ eveniment := mockFactory. ventTask()

-- poarta := mock.Gate()
++ poarta := mockFactory.Gate()

-- grpc := mock.Grpc()
++ grpc := mockFactory. rpc()

-- hash := mock.Hash()
++ hash := mockFactory.Hash()

-- mock.Log()
++ mockFactory. og()

-- mail := mock.Mail()
++ mail := mockFactory.Mail()

-- orm, interogare, tranzacÅ£ie, asociere := mock. rm()
++ orm := mockFactory.Orm()
++ interogare := mockFactory.OrmQuery()
++ tranzacÈ›ie := mockFactory. rmTransaction()
++ asociere := mockFactory.OrmAssociation()

-- coadÄƒ, sarcinÄƒ := mock.CoadÄƒ()
++ coadÄƒ := mockFactory. ueue()
++ sarcinÄƒ := mockFactory.QueueTask()

-- rateLimiter := mock.RateLimiter()
++ rateLimiter := mockFactory. ateLimiter()

-- stocare, driver, fiÈ™ier := mock.Storage()
++ stocare := mockFactory.Storage()
++ driver := mockFactory. torageDriver()
++ fiÈ™ier := mockFactory.StorageFile()

-- seeder := mock.Seeder()
++ seeder := mockFactory. eeder()

-- validare, validare, erori := mock.Validation()
++ validare := mockFactory.Validation()
++ validator := mockFactory. alidationValidator()
++ erori := mockFactory.ValidareErrors()

-- vizualizare := mock.View()
++ vedere := mockFactory.View()
```

### Modelul Framework Orm adaugÄƒ eticheta json

Versiune: v1.14.0

DacÄƒ folosiÈ›i modelul Orm al Cadrului È™i returnaÈ›i datele direct prin punctul final, trebuie sÄƒ creezi un nou model
Ã®n funcÈ›ie de vechea È™i sÄƒ Ã®nlocuieÈ™ti vechiul, sau frontend trebuie sÄƒ modifice numele cÃ¢mpului Ã®n funcÅ£ie de eticheta json

```go
type Model struct {
 -- ID uint `gorm:"primaryKey"`
 ++ ID uint `gorm:"primaryKey" json:"id"`
 Timestamps
}

type SoftDeletes struct {
 -- DeletedAt gorm.DeletedAt `gorm:"column:deleted_at"`
 ++ DeletedAt gorm.DeletedAt `gorm:"column:deleted_at" json:"deleted_at"`
}

type Timestamps struct {
 -- CreatedAt carbon.DateTime `gorm:"autoCreateTime;column:created_at"`
 -- UpdatedAt carbon.DateTime `gorm:"autoUpdateTime;column:updated_at"`
 ++ CreatedAt carbon.DateTime `gorm:"autoCreateTime;column:created_at" json:"created_at"`
 ++ UpdatedAt carbon.DateTime `gorm:"autoUpdateTime;column:updated_at" json:"updated_at"`
}
```

### ReparÄƒ sesiunea nu este setatÄƒ cu succes Ã®n È™oferul gin

goravel/framework: v1.14.1

### RemediaÈ›i fiÈ™ierul de limbÄƒ nu poate fi citit Ã®n modulul de localizare

goravel/framework: v1.14.1

### Reparare verificare validare imagine È™i fiÈ™ier eÈ™uatÄƒ

goravel/framework: v1.14.2

goravel/gin: v1.2.2

goravel/fiber: v1.2.2

[Problema #450](https://github.com/goravel/goravel/issues/450)

### ReparÄƒ cookie-urile setate de È™oferul goravel/gin nu sunt valide

goravel/gin: v1.2.2

### Remedierea validÄƒrii nu poate lega felia

goravel/framework: v1.14.3

```go
type User struct {
 Tags []string `form:"tags" json:"tags"`
}
```

### Validarea suportÄƒ legarea carbonului

goravel/framework: v1.14.3

```go
// DefineÈ™te cÃ¢mpul de carbon
type User struct {
 Date carbon.Carbon `form:"date" json:"date"`
}
var user requests. ser

// UtilizaÈ›i erorile ValidateRequest de legare a datelor
, err := ctx.Request(). alidateRequest(&user)

// sau utilizaÈ›i validatorul validator de validare
, err := ctx.Request(). alidate(harta[string]string{
  "date": "required<unk> date",
})
err := validator.Bind(&user)

// obÈ›ine data de
user.Date.ToDateTimeString()
```

### ReparÄƒ problema simultanÄƒ a sesiunii

goravel/framework: v1.14.4

CÃ¢nd conmoneda de sesiune este prea mare, ar putea exista o problemÄƒ de citire È™i scriere a conflictelor.

### ReparÄƒ setul de Gin Sesiune nevalid

goravel/gin: v1.2.3

[Problema #455](https://github.com/goravel/goravel/issues/455)

### AdaugÄƒ metodÄƒ de oprire pentru RutÄƒ

goravel/framework: v1.14.5

goravel/gin: v1.2.4

goravel/fiber: v1.2.3

[Document](../basic/routing#shutdown)

### OptimizeazÄƒ metoda ctx.Retragere a HTTP

goravel/framework: v1.14.7

goravel/gin: v1.2.5

goravel/fiber: v1.2.4

Metoda `key` `ctx.WithValue` este schimbatÄƒ de la suportarea tipului `string` la suportarea tipului `any`.

```go
ctx.WithValue("Salut", "world")
ctx.WithValue(1, "hi")

var key struct{}
ctx.WithValue(key, "hola")
```

### Rezolvarea problemei de Ã®nregistrare a ascultÄƒtorilor conflictualÄƒ

goravel/framework: v1.14.8

Evenimente multiple folosesc acelaÈ™i ascultÄƒtor, un conflict de ascultÄƒtori va fi determinat la Ã®nregistrare.

[Problema #523](https://github.com/goravel/goravel/issues/523)

### RezolvÄƒ problema de tipÄƒrire repetatÄƒ a consolei personalizate Log driver

goravel/framework: v1.14.9

[Problema #531](https://github.com/goravel/goravel/issues/531)

### RemediaÈ›i problema erorii de legare a datelor atunci cÃ¢nd cererea HTTP JSON conÈ›ine o structurÄƒ pe mai multe niveluri

goravel/framework: v1.14.9

[Problema #533](https://github.com/goravel/goravel/issues/533)
