# Actualizare la v1.14 De la v1.13

### Funcții noi sunt incredibile 🎉

- [Localization](#localization)
- [Installer](#installer)
- [Cookie](#cookie)
- [Session](#session)

### Îmbunătățiri 🚀

- [Suport pentru setarea body_limit și header_limit în Gin și Fiber drivers](#support-for-setting-body-limit-and-header-limit-in-gin-and-fiber-drivers)
- [Log add new methods](#log-adds-new-methods)
- [Orm adaugă metode noi](#orm-adds-new-methods)
- [Console adaugă metode noi](#console-adds-new-methods)
- [Response add new methods](#response-adds-new-methods)
- [Adaugă comandă de construcție](#add-build-command)
- [Add helper methods](#add-helper-methods)
- [Driver-ul Redis acceptă TLS](#redis-driver-supports-tls)

### Ruperea modificărilor 🛠️

- [Validarea nu va lega datele dacă validarea eșuează](#validation-will-not-bind-data-if-validation-fails)
- [Adăugați metode noi și modificați metodele pentru modulul de testare](#add-new-methods-and-modify-methods-for-testing-module)
- [Optimizați metoda de coadă a e-mailului](#optimize-the-queue-method-of-mail)
- [Optimizați metoda de setare a modulului Auth ctx](#optimize-the-setting-method-of-the-auth-module-ctx)
- [Optimizați modul de fațade mocs](#optimize-the-way-of-mock-facades)
- [Framework Orm model add json tag](#framework-orm-model-adds-json-tag)

### v1.14.1

- [Repară sesiunea nu este setată cu succes în driver-ul gin ](#fix-the-session-is-not-set-successfully-in-the-gin-driver)
- [Remediați fișierul de limbă nu poate fi citit în modulul de localizare](#fix-the-language-file-cannot-be-read-in-the-localization-module)

### v1.14.2

- [Fix Validation verification of image and file failed](#fix-validation-verification-of-image-and-file-failed)
- [Fix the cookie Expirres set by the goravel/gin driver is invalid](#fix-the-cookie-expires-set-by-the-goravel-gin-driver-is-invalid)

### v1.14.3

Modernizarea ambalajelor înrudite: goravel/gin: v1.2.2, goravel/fibră: v1.2.2

- [Fix Validarea nu poate lega felia](#fix-validation-cannot-bind-slice)
- [Validarea suportă legarea de carbon](#validation-supports-bind-carbon)

### v1.14.4

Îmbunătățește pachetele corespunzătoare: goravel/gin: v1.2.3

- [Remediere problemă simultană de sesiune](#fix-session-concurrent-problem)
- [Fix Gin set Same_site invalid](#fix-gin-sets-session-same_site-invalid)

### v1.14.5

Modernizarea ambalajelor înrudite: goravel/gin: v1.2.4, goravel/fibră: v1.2.3

- [Adăugare metodă de oprire pentru rută](#add-shutdown-method-for-route)

### v1.14.7

Modernizează pachetele corespunzătoare: goravel/gin: v1.2.5, goravel/fibră: v1.2.4

- [Optimizează metoda ctx.Retragerea HTTP](#optimize-the-ctx-withvalue-method-of-http)

### v1,14,8

- [Remediați problema de înregistrare a ascultătorilor](#fix-the-problem-of-conflicting-listener-registration)

### v1,14,9

- [Rezolvă problema de personalizare a consolei de tip Log Driver în mod repetat printare](#fix-the-problem-of-custom-log-driver-console-repeatedly-printing)
- [Remediați problema erorii de legare a datelor atunci când cererea HTTP JSON conține o structură pe mai multe nivele](#fix-the-problem-of-data-binding-error-when-http-json-request-contains-multi-level-structure)

## Ghid de actualizare

Goravel v1.14 este dezvoltat şi testat pe baza Golang 1.21 şi este în general compatibil cu alte versiuni Golang inferioare.
Vă rugăm să actualizați framework-ul pas cu pas în funcție de conținutul din această secțiune.

**Timp estimat de actualizare: 10 minute**

### 1. Actualizarea dependentelor

```
go get -u github.com/goravel/framework@v1.14.7

// If using gin
go get -u github.com/goravel/gin@v1.2.5

// If using fiber
go get -u github.com/goravel/fiber@v1.2.4

// If using redis
go get -u github.com/goravel/redis@v1.2.1

// If using s3
go get -u github.com/goravel/s3@v1.2.0

// If using oss
go get -u github.com/goravel/oss@v1.2.0

// If using cos
go get -u github.com/goravel/cos@v1.2.0

// If using minio
go get -u github.com/goravel/minio@v1.2.0

// If using cloudinay
go get -u github.com/goravel/cloudinary@v1.2.0

go mod tidy
```

### 2. Adăugarea elementelor de configurare

1. `config/app.go` adaugă elemente de configurare a modulului de localizare:

```go
"locale": "ro",
"fallback_locale": "en",
"providers": []foundation.ServiceProvider{
  ...
  &session.ServiceProvider{},
  &translation.ServiceProvider{},
  ...
}
```

2. Dacă vrei să folosești funcția `session`, adaugă
 fișierul [config/session.go](https://github.com/goravel/goravel/blob/master/config/session.go);

### 3) Dacă utilizaţi modulul de validare

Confirmați dacă încă încercați să citiți valoarea obligatorie chiar dacă validarea datelor eșuează. If so, you need to
optimize the logic, because the value is empty after the upgrade.
Vedeți: [Validarea nu va lega datele dacă validarea eșuează](#validation-will-not-bind-data-if-validation-fails).

### 4. Dacă se utilizează modulul Testare

Verificați dacă utilizați metodele `Clear`, `Image`, dacă da, trebuie să modificați
în consecință: [Adăugați metode noi și modificați metodele pentru modulul de testare](#add-new-methods-and-modify-methods-for-testing-module)

### 5. dacă utilizați modulul Mail

Verificați dacă utilizarea metodei `coadă`, dacă da, trebuie să modificați
în consecință: [Optimizați metoda de coadă pentru e-mail](#optimize-the-queue-method-of-mail)

### 6. Dacă se utilizează modulul Auth

Trebuie să modifici
în consecință: [Optimizează metoda de setare a modulului Auth ctx](#optimize-the-setting-method-of-the-auth-module-ctx)

### 7. Dacă se utilizează faţadele mock

Trebuie modificat în consecință: [Optimizați modul de fațade mock-uri](#optimize-the-way-of-mock-facades)

### 8. Dacă se utilizează modelul framework Orm și se returnează datele direct prin punctul final

Necesitatea modificării în consecință: [Modelul Framework Orm adaugă json tag](#framework-orm-model-adds-json-tag)

## Introducere caracteristică

### Localizare

Versiune: v1.14.0

[Vezi documentația](../advanced/localization)

### Instalare

Versiune: v1.14.0

Instalatorul vă permite să descărcați cu ușurință și să inițializați un nou proiect Goravel.

[Vezi documentația](http://github.com/goravel/installer)

### Cookie

Versiune: v1.14.0

[Vezi documentația cererii](../basic/requests#cookie)

[Vezi documentația răspunsului](../basic/responses#cookie)

### Sesiune

Versiune: v1.14.0

[Vezi documentația](../basic/session)

### Suport pentru setarea body_limit și header_limit în modulele-pilot de fibră și fibră

Versiune: v1.14.0

Șoferii HTTP suportă setarea body_limit pentru a limita dimensiunea corpului,
vedeți: [goravel/gin](https://github.com/goravel/gin/blob/c9d7706a6a04c05c8c33af5c97877a1ad2ea6362/README.md?plain=1#L54)
și [goravel/fiber](https://github.com/goravel/fiber/blob/aa63ab657cd2b371fcda4df0090a41226f6c0704/README.md?plain=1#L56).

### Log adaugă metode noi

Versiune: v1.14.0

| Metodă      | Descrpton                                  |
| ----------- | ------------------------------------------ |
| `Stack`     | Utilizați mai multe canale în același timp |
| `Channel`   | A fost specificat un canal                 |
| `WithTrace` | Tipărește urmele                           |

[Vezi documentația](../basic/logging#write-to-a-specific-channel)

### Orm adaugă metode noi

Versiune: v1.14.0

Add `WhereIn`, `OrWhereIn`, `OrWhereNotIn`, `WhereNotIn`, `WhereBetween`, `WhereNotBetween`, `WhereNull`, `OrWhereNull`,
`OrderByDesc`, `OrderBy`, `InRandomOrder`, `Exists`.

### Consola adaugă metode noi

Versiune: v1.14.0

[Vezi documentația](../advanced/artisan#prompting-for-input)

### Răspunsul adaugă noi metode

Versiune: v1.14.0

[Vezi documentația](../basic/responses#no-content)

### Adaugă comandă de construcție

Versiune: v1.14.0

Proiectul Goravel poate fi compilat cu următoarea comandă: \`go run . clădirea artizanală".

[Vezi documentația](../quickstart/compile#compile-command)

### Adaugă metode de ajutor

Versiune: v1.14.0

- [Str](../advanced/strings)
- [Map](../advanced/helpers#maps)
- [Color](../advanced/color)
- [Convert](../advanced/helpers#convert)
- [Collect](../advanced/helpers#collect)

### Șoferul Redis acceptă TLS

Versiune: v1.14.0

[Vezi documentația](https://github.com/goravel/redis)

### Validarea nu va lega datele dacă validarea eșuează

Versiune: v1.14.0

Anterior, atunci când apelează metodele de mai jos, `userRequest` încă asociază valoarea, chiar dacă eroarea era returnată.
După actualizare, nu se va mai lega.

```go
var userRequest requests.UserRequest
erori, err := ctx.Request().ValidateRequest(&userRequest)

// sau
validator, err := validation.Make(***)
err = validator.Bind(&userRequest)
```

### Adăugați metode noi și modificați metodele pentru modulul de testare

Versiune: v1.14.0

1. Adaugă metoda [Fresh](../testing/quickstart#refresh-database;
2. Modifică metoda `Clear` la metoda [Stop](../testing/quickstart#uninstall-image);
3. Metoda `Image` adaugă variabila `ExposedPorts` şi elimină variabila `Timeout`;

```go
Baza de date, err := facades.Testing().Docker().Database()
bază de date.Image(testingcontract.Image{
  Repository: "mysql",
  Tag: "5. ",
  Env: []string{
    "MYSQL_ROOT_PASSWORD=123123",
    "MYSQL_DATABASE=goravel",
  },
  -- Timeout: 1000,
  ++ ExpozedPorts: []string{"3306"},
})
```

### Optimizează metoda de coadă a e-mailului

Versiune: v1.14.0

Parametrul de intrare al metodei `Coadă` se schimbă de la `coada *mail.Coadă` la `coada ...mail.Coadă`.

```diff
-- facades.Mail().Queue(nil)
++ facades.Mail().Coadă()

-- facades.Mail().Coadă (&mail.Coadă{})
++ facades.Mail().Coadă (mail.Coada{})
```

### Optimizează metoda de setare a modulului Auth ctx

Versiune: v1.14.0

Anterior, când apelați la `Parse`, `User`, `Login`, `LoginUsingID`, `Refresh`, metode `Logout`, trebuie să treceți de la
`ctx`. După upgrade, nu mai ai nevoie să treci `ctx`, îl poți seta direct în `facades.Auth(ctx)`.

```diff
-- facades.Auth().Parse(ctx, token)
++ facades.Auth(ctx).Parse(token)

-- facades.Auth().User(ctx, &user)
++ facades.Auth(ctx).User(&user)

-- facades.Auth().Login(ctx, &user)
++ facades.Auth(ctx). ogin(&user)

-- facades.Auth().LoginUsingID(ctx, id)
++ faades.Auth(ctx).LoginUsingID(id)

-- facades.Auth().Refresh(ctx)
++ faades.Auth(ctx).Refresh()

-- facades.Auth().Logout(ctx)
++ facs.Auth(ctx).Logout()
```

### Optimizați modul de fațade mock

Versiune: v1.14.0

```diff
import github.com/goravel/framework/testing/mock

++ mockFactory := mock.Factory()

-- app := mock.App()
++ app := mockFactory. pp()

-- artizan := mock.Artisan()
++ artizan := mockFactory.Artisan()

-- auth := mock. uth()
++ auth := mockFactory.Auth()

-- artizan := mock.Artisan()
++ artizan := mockFactory.Artisan()

-- cache, driver, blocare := mock. ache()
++ cache := mockFactory.Cache()
++ driver := mockFactory.CacheDriver()
++ blocare := mockFactory. acheLock()

-- config := mock.Config()
++ config := mockFactory.Config()

-- crypt := mock.Crypt()
++ cript := mockFactory. rypt()

-- eveniment, sarcină := mock.Event()
++ eveniment := mockFactory.Event()
++ eveniment := mockFactory. ventTask()

-- poarta := mock.Gate()
++ poarta := mockFactory.Gate()

-- grpc := mock.Grpc()
++ grpc := mockFactory. rpc()

-- hash := mock.Hash()
++ hash := mockFactory.Hash()

-- mock.Log()
++ mockFactory. og()

-- mail := mock.Mail()
++ mail := mockFactory.Mail()

-- orm, interogare, tranzacţie, asociere := mock. rm()
++ orm := mockFactory.Orm()
++ interogare := mockFactory.OrmQuery()
++ tranzacție := mockFactory. rmTransaction()
++ asociere := mockFactory.OrmAssociation()

-- coadă, sarcină := mock.Coadă()
++ coadă := mockFactory. ueue()
++ sarcină := mockFactory.QueueTask()

-- rateLimiter := mock.RateLimiter()
++ rateLimiter := mockFactory. ateLimiter()

-- stocare, driver, fișier := mock.Storage()
++ stocare := mockFactory.Storage()
++ driver := mockFactory. torageDriver()
++ fișier := mockFactory.StorageFile()

-- seeder := mock.Seeder()
++ seeder := mockFactory. eeder()

-- validare, validare, erori := mock.Validation()
++ validare := mockFactory.Validation()
++ validator := mockFactory. alidationValidator()
++ erori := mockFactory.ValidareErrors()

-- vizualizare := mock.View()
++ vedere := mockFactory.View()
```

### Modelul Framework Orm adaugă eticheta json

Versiune: v1.14.0

Dacă folosiți modelul Orm al Cadrului și returnați datele direct prin punctul final, trebuie să creezi un nou model
în funcție de vechea și să înlocuiești vechiul, sau frontend trebuie să modifice numele câmpului în funcţie de eticheta json

```go
type Model struct {
 -- ID uint `gorm:"primaryKey"`
 ++ ID uint `gorm:"primaryKey" json:"id"`
 Timestamps
}

type SoftDeletes struct {
 -- DeletedAt gorm.DeletedAt `gorm:"column:deleted_at"`
 ++ DeletedAt gorm.DeletedAt `gorm:"column:deleted_at" json:"deleted_at"`
}

type Timestamps struct {
 -- CreatedAt carbon.DateTime `gorm:"autoCreateTime;column:created_at"`
 -- UpdatedAt carbon.DateTime `gorm:"autoUpdateTime;column:updated_at"`
 ++ CreatedAt carbon.DateTime `gorm:"autoCreateTime;column:created_at" json:"created_at"`
 ++ UpdatedAt carbon.DateTime `gorm:"autoUpdateTime;column:updated_at" json:"updated_at"`
}
```

### Repară sesiunea nu este setată cu succes în șoferul gin

goravel/framework: v1.14.1

### Remediați fișierul de limbă nu poate fi citit în modulul de localizare

goravel/framework: v1.14.1

### Reparare verificare validare imagine și fișier eșuată

goravel/framework: v1.14.2

goravel/gin: v1.2.2

goravel/fiber: v1.2.2

[Problema #450](https://github.com/goravel/goravel/issues/450)

### Repară cookie-urile setate de șoferul goravel/gin nu sunt valide

goravel/gin: v1.2.2

### Remedierea validării nu poate lega felia

goravel/framework: v1.14.3

```go
type User struct {
 Tags []string `form:"tags" json:"tags"`
}
```

### Validarea suportă legarea carbonului

goravel/framework: v1.14.3

```go
// Definește câmpul de carbon
type User struct {
 Date carbon.Carbon `form:"date" json:"date"`
}
var user requests. ser

// Utilizați erorile ValidateRequest de legare a datelor
, err := ctx.Request(). alidateRequest(&user)

// sau utilizați validatorul validator de validare
, err := ctx.Request(). alidate(harta[string]string{
  "date": "required<unk> date",
})
err := validator.Bind(&user)

// obține data de
user.Date.ToDateTimeString()
```

### Repară problema simultană a sesiunii

goravel/framework: v1.14.4

Când conmoneda de sesiune este prea mare, ar putea exista o problemă de citire și scriere a conflictelor.

### Repară setul de Gin Sesiune nevalid

goravel/gin: v1.2.3

[Problema #455](https://github.com/goravel/goravel/issues/455)

### Adaugă metodă de oprire pentru Rută

goravel/framework: v1.14.5

goravel/gin: v1.2.4

goravel/fiber: v1.2.3

[Document](../basic/routing#shutdown)

### Optimizează metoda ctx.Retragere a HTTP

goravel/framework: v1.14.7

goravel/gin: v1.2.5

goravel/fiber: v1.2.4

Metoda `key` `ctx.WithValue` este schimbată de la suportarea tipului `string` la suportarea tipului `any`.

```go
ctx.WithValue("Salut", "world")
ctx.WithValue(1, "hi")

var key struct{}
ctx.WithValue(key, "hola")
```

### Rezolvarea problemei de înregistrare a ascultătorilor conflictuală

goravel/framework: v1.14.8

Evenimente multiple folosesc același ascultător, un conflict de ascultători va fi determinat la înregistrare.

[Problema #523](https://github.com/goravel/goravel/issues/523)

### Rezolvă problema de tipărire repetată a consolei personalizate Log driver

goravel/framework: v1.14.9

[Problema #531](https://github.com/goravel/goravel/issues/531)

### Remediați problema erorii de legare a datelor atunci când cererea HTTP JSON conține o structură pe mai multe niveluri

goravel/framework: v1.14.9

[Problema #533](https://github.com/goravel/goravel/issues/533)
